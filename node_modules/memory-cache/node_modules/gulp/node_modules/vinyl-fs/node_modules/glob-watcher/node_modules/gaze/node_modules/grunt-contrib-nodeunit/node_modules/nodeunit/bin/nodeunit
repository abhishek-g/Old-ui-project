#!/usr/bin/env node

var
    fs = require('fs'),
    path = require('path');

// TODO: remove this when https://github.com/joyent/node/pull/1312
//       lands in core.
//
// Until then, use console.log from npm (https://gist.github.com/1077544)
require('../deps/console.log');

//require.paths.push(process.cwd());
var args = (process.ARGV || process.argv).slice(2);

var files = [];

var testrunner,
    config_file,
    config_param_found = false,
    output_param_found = false,
    reporter_file = 'default',
    reporter_param_found = false,
    testspec_param_found = false;
    testFullSpec_param_found = false;

var usage = "Usage: nodeunit [options] testmodule1.js testfolder [...] \n" +
            "Options:\n\n" +
            "  --config FILE     the path to a JSON file with options\n" +
            "  --reporter FILE   optional path to a reporter file to customize the output\n" +
            "  --list-reporters  list available build-in reporters\n" +
            "  -t name,          specify a test to run\n" +
            "  -f fullname,      specify a specific test to run. fullname is built so: \"outerGroup - .. - innerGroup - testName\"\n"  + 
            "  -h, --help        display this help and exit\n" +
            "  -v, --version     output version information and exit";
            


// load default options
var content = fs.readFileSync(__dirname + '/nodeunit.json', 'utf8');
var options = JSON.parse(content);

// a very basic pseudo --options parser
args.forEach(function (arg) {
    if (arg.slice(0