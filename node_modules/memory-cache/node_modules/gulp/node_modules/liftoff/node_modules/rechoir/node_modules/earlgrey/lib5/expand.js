
"use strict";require("earlgrey-runtime/5");var $targ$1 = undefined;var accum$0 = undefined;var $targ$2 = undefined;var accum$1 = undefined;var $targ$14 = undefined;var accum$2 = undefined;var $targ$15 = undefined;var accum$3 = undefined;var $targ$17 = undefined;var accum$4 = undefined;var $targ$18 = undefined;var accum$5 = undefined;var $targ$32 = undefined;var accum$6 = undefined;var $targ$33 = undefined;var accum$7 = undefined;var $targ$34 = undefined;var $targ$35 = undefined;var $targ$36 = undefined;var $targ$37 = undefined;var $targ$38 = undefined;var $targ$39 = undefined;var $targ$40 = undefined;var $targ$41 = undefined;var $targ$42 = undefined;var $0$0 = undefined;var transferLocation$0 = undefined;var Source$0 = undefined;var util$0 = undefined;var classify$0 = undefined;var GenSym$0 = undefined;var gensym$0 = undefined;var camelCase$0 = undefined;var invCamelCase$0 = undefined;var $2$0 = undefined;var tokenize$0 = undefined;var $3$0 = undefined;var parse$0 = undefined;var __lt____lt____colon__$0 = undefined;var jsKeywords$0 = undefined;var Scope$0 = undefined;var Env$0 = undefined;var track_location$0 = undefined;var Info$0 = undefined;var Expander$0 = undefined;var topscope$0 = undefined;$0$0 = require("./location");transferLocation$0 = getProperty($0$0, "<<:", "./location");Source$0 = getProperty($0$0, "Source", "./location");util$0 = require("./util");classify$0 = getProperty(util$0, "classify", "util");GenSym$0 = getProperty(util$0, "GenSym", "util");gensym$0 = getProperty(util$0, "gensym", "util");camelCase$0 = getProperty(util$0, "camelCase", "util");invCamelCase$0 = getProperty(util$0, "invCamelCase", "util");$2$0 = require("./lex");tokenize$0 = getProperty($2$0, "tokenize", "./lex");$3$0 = require("./parse");parse$0 = getProperty($3$0, "parse", "./parse");__lt____lt____colon__$0 = function (a$0, b$0) {
  var $$1322$0 = undefined;var m$0$0 = undefined;transferLocation$0(a$0, b$0);m$0$0 = a$0;if (getChecker(Error)(m$0$0)) {
    return a$0;
  } else {
    if (b$0.name) {
      return __amp____colon__(a$0, { name: b$0.name });
    } else {
      return a$0;
    }
  }
};jsKeywords$0 = "abstract arguments boolean break byte\n              case catch char class const\n              continue debugger default delete do\n              double else enum eval export\n              extends false final finally float\n              for function goto if implements\n              import in instanceof int interface\n              let long native new null\n              package private protected public return\n              short static super switch synchronized\n              this throw throws transient true\n              try typeof var void volatile\n              while with yield".split(RegExp("[ \\n]+", ""));Scope$0 = function Scope() {
  var $targ$0 = undefined;var t0$0 = undefined;var m$1$0 = undefined;var $it$0 = undefined;if (!getChecker(Scope$0)(this)) {
    $it$0 = Object.create(Scope$0.prototype);
  } else {
    $it$0 = this;
  }m$1$0 = arguments;t0$0 = m$1$0.length;if (t0$0 >= 0 && t0$0 <= 3) {
    $it$0.parent = 0 >= t0$0 ? null : m$1$0[0];$it$0.name = 1 >= t0$0 ? gensym$0("scope") : m$1$0[1];$it$0.top = 2 >= t0$0 ? false : m$1$0[2];$targ$0 = {};$it$0.options = $targ$0;void 0;
  } else {
    ___match_error(m$1$0, "{@parent = null\n               @name = gensym{\"scope\"}\n               @top = false}");
  }return $it$0;
};Scope$0.prototype.fork = function fork() {
  var $it$1 = undefined;var self$0 = undefined;$it$1 = this;self$0 = this;return Scope$0($it$1);
};Scope$0.prototype.toString = function toString() {
  var $it$2 = undefined;var self$1 = undefined;$it$2 = this;self$1 = this;return "Scope{" + $it$2.name + "}";
};__amp____colon__(Scope$0, __amp____colon__(($targ$1 = "Scope", accum$0 = {}, accum$0["::name"] = $targ$1, accum$0), ($targ$2 = true, accum$1 = {}, accum$1["::egclass"] = $targ$2, accum$1)));Env$0 = function Env() {
  var $targ$3 = undefined;var $targ$4 = undefined;var $it$3 = undefined;if (!getChecker(Env$0)(this)) {
    $it$3 = Object.create(Env$0.prototype);
  } else {
    $it$3 = this;
  }$targ$3 = {};$it$3.scopes = $targ$3;$targ$4 = {};$it$3.options = $targ$4;return $it$3;
};Env$0.prototype.list_bindings = function list_bindings(origin$0) {
  var values$0 = undefined;var scope$0 = undefined;var $it$4 = undefined;var self$2 = undefined;$it$4 = this;self$2 = this;values$0 = {};scope$0 = origin$0;$4: while (scope$0) {
    __amp____colon__(values$0, send(send($it$4, "scopes", true), scope$0.name));scope$0 = scope$0.parent;scope$0;
  }return values$0;
};Env$0.prototype.getopt = function getopt() {
  var scope_data$0 = undefined;var scope$1 = undefined;var name$0 = undefined;var level$0 = undefined;var t0$1 = undefined;var m$2$0 = undefined;var $it$5 = undefined;var self$3 = undefined;$it$5 = this;self$3 = this;m$2$0 = arguments;t0$1 = m$2$0.length;if (t0$1 >= 2 && t0$1 <= 3) {
    scope$1 = m$2$0[0];name$0 = m$2$0[1];if (2 >= t0$1) {
      level$0 = 0;
    } else {
      level$0 = m$2$0[2];
    }if (scope$1 === null) {
      return undefined;
    }scope_data$0 = send(send($it$5, "options", true), scope$1.name);if (scope_data$0 && Object.prototype.hasOwnProperty.call(scope_data$0, name$0)) {
      if (equal(level$0, 0)) {
        return send(scope_data$0, name$0);
      } else {
        return $it$5.getopt(scope$1.parent, name$0, level$0 - 1);
      }
    } else {
      return $it$5.getopt(scope$1.parent, name$0, level$0);
    }
  } else {
    return ___match_error(m$2$0, "{scope, name, level = 0}");
  }
};Env$0.prototype.setopt = function setopt(scope$2, name$1, value$0) {
  var $targ$6 = undefined;var t0$2 = undefined;var s$0 = undefined;var $targ$5 = undefined;var $it$6 = undefined;var self$4 = undefined;$it$6 = this;self$4 = this;if (!send(send($it$6, "options", true), scope$2.name)) {
    $targ$6 = {};$it$6.options[scope$2.name] = $targ$6;void 0;
  }s$0 = send(send($it$6, "options", true), scope$2.name);$targ$5 = value$0;t0$2 = $targ$5;s$0[name$1] = t0$2;s$0[camelCase$0(name$1)] = t0$2;s$0[invCamelCase$0(name$1)] = t0$2;return void 0;
};Env$0.prototype.resolve = function resolve() {
  var scope_data$1 = undefined;var scope$3 = undefined;var name$2 = undefined;var level$1 = undefined;var t0$3 = undefined;var m$3$0 = undefined;var $it$7 = undefined;var self$5 = undefined;$it$7 = this;self$5 = this;m$3$0 = arguments;t0$3 = m$3$0.length;if (t0$3 >= 2 && t0$3 <= 3) {
    scope$3 = m$3$0[0];name$2 = m$3$0[1];if (2 >= t0$3) {
      level$1 = 0;
    } else {
      level$1 = m$3$0[2];
    }if (scope$3 === null) {
      return undefined;
    }scope_data$1 = send(send($it$7, "scopes", true), scope$3.name);if (scope_data$1 && Object.prototype.hasOwnProperty.call(scope_data$1, name$2)) {
      if (equal(level$1, 0)) {
        return send(scope_data$1, name$2);
      } else {
        return $it$7.resolve(scope$3.parent, name$2, level$1 - 1);
      }
    } else {
      return $it$7.resolve(scope$3.parent, name$2, level$1);
    }
  } else {
    return ___match_error(m$3$0, "{scope, name, level = 0}");
  }
};Env$0.prototype.bind = function bind(scope$4, name$3, value$1) {
  var $targ$8 = undefined;var $targ$9 = undefined;var t0$4 = undefined;var s$1 = undefined;var $targ$7 = undefined;var $it$8 = undefined;var self$6 = undefined;$it$8 = this;self$6 = this;if (!send(send($it$8, "scopes", true), scope$4.name)) {
    $targ$8 = {};$it$8.scopes[scope$4.name] = $targ$8;void 0;
  }if (scope$4.top) {
    $targ$9 = true;value$1.top = $targ$9;void 0;
  }s$1 = send(send($it$8, "scopes", true), scope$4.name);$targ$7 = value$1;t0$4 = $targ$7;s$1[name$3] = t0$4;s$1[camelCase$0(name$3)] = t0$4;s$1[invCamelCase$0(name$3)] = t0$4;return void 0;
};Env$0.prototype.mark = function mark(expr$0) {
  var x$0 = undefined;var x$1 = undefined;var bridge$$1625$0 = undefined;var x$2 = undefined;var bridge$$1624$0 = undefined;var x$3 = undefined;var bridge$$1623$0 = undefined;var x$4 = undefined;var m$5 = undefined;var other$0 = undefined;var type$0 = undefined;var args$0 = undefined;var e$0 = undefined;var bridge$$1622$0 = undefined;var t0$5 = undefined;var m$4$0 = undefined;var $it$9 = undefined;var self$7 = undefined;$it$9 = this;self$7 = this;m$4$0 = expr$0;if (___hasprop(m$4$0, "env")) {
    e$0 = m$4$0.env;return expr$0;
  } else {
    bridge$$1622$0 = m$4$0;if ((bridge$$1623$0 = bridge$$1622$0, (bridge$$1624$0 = bridge$$1623$0, (bridge$$1625$0 = bridge$$1624$0, (x$0 = bridge$$1625$0, x$0 instanceof Array && x$0[0] === "symbol") || (x$1 = bridge$$1625$0, x$1 instanceof Array && x$1[0] === "value")) || (x$2 = bridge$$1624$0, x$2 instanceof Array && x$2[0] === "variable")) || (x$3 = bridge$$1623$0, x$3 instanceof Array && x$3[0] === "macro")) || (x$4 = bridge$$1622$0, x$4 instanceof Array && x$4[0] === "void")) {
      return __amp____colon__(expr$0, { env: $it$9 });
    } else {
      if (Array.isArray(m$4$0) && (t0$5 = m$4$0.length, t0$5 >= 1)) {
        type$0 = m$4$0[0];args$0 = Array.prototype.slice.call(m$4$0, 1);m$5 = null;var _iteratorNormalCompletion = true;
        var _didIteratorError = false;
        var _iteratorError = undefined;

        try {
          $5: for (var _iterator = args$0[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            m$5 = _step.value;
            var arg$0 = undefined;arg$0 = m$5;$it$9.mark(arg$0);
          }
        } catch (err) {
          _didIteratorError = true;
          _iteratorError = err;
        } finally {
          try {
            if (!_iteratorNormalCompletion && _iterator["return"]) {
              _iterator["return"]();
            }
          } finally {
            if (_didIteratorError) {
              throw _iteratorError;
            }
          }
        }

        return __amp____colon__(expr$0, { env: $it$9 });
      } else {
        other$0 = m$4$0;return other$0;
      }
    }
  }
};Env$0.prototype.fork = function fork() {
  var m$6 = undefined;var m$8 = undefined;var e$1 = undefined;var $it$10 = undefined;var self$8 = undefined;$it$10 = this;self$8 = this;e$1 = Env$0();m$6 = null;var _iteratorNormalCompletion = true;
  var _didIteratorError = false;
  var _iteratorError = undefined;

  try {
    $6: for (var _iterator = items($it$10.scopes)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
      m$6 = _step.value;
      var m$7 = undefined;var acc$0 = undefined;var temp$0 = undefined;var scope$5 = undefined;var bindings$0 = undefined;var t0$6 = undefined;var t1$0 = undefined;t0$6 = m$6;if (Array.isArray(t0$6) && (t1$0 = t0$6.length, t1$0 === 2)) {
        scope$5 = t0$6[0];bindings$0 = t0$6[1];acc$0 = [];temp$0 = null;m$7 = null;var _iteratorNormalCompletion2 = true;
        var _didIteratorError2 = false;
        var _iteratorError2 = undefined;

        try {
          $8: for (var _iterator2 = items(bindings$0)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
            m$7 = _step2.value;
            var $targ$11 = undefined;var $targ$10 = undefined;var k$0 = undefined;var v$0 = undefined;var t0$7 = undefined;var t1$1 = undefined;t0$7 = m$7;if (Array.isArray(t0$7) && (t1$1 = t0$7.length, t1$1 === 2)) {
              k$0 = t0$7[0];v$0 = t0$7[1];if (!send(send(e$1, "scopes", true), scope$5)) {
                $targ$11 = {};e$1.scopes[scope$5] = $targ$11;void 0;
              }$targ$10 = v$0;send(send(e$1, "scopes", true), scope$5)[k$0] = $targ$10;temp$0 = void 0;acc$0.push(temp$0);
            } else {
              ___match_error(m$7);
            }
          }
        } catch (err) {
          _didIteratorError2 = true;
          _iteratorError2 = err;
        } finally {
          try {
            if (!_iteratorNormalCompletion2 && _iterator2["return"]) {
              _iterator2["return"]();
            }
          } finally {
            if (_didIteratorError2) {
              throw _iteratorError2;
            }
          }
        }

        acc$0;
      } else {
        ___match_error(m$6);
      }
    }
  } catch (err) {
    _didIteratorError = true;
    _iteratorError = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion && _iterator["return"]) {
        _iterator["return"]();
      }
    } finally {
      if (_didIteratorError) {
        throw _iteratorError;
      }
    }
  }

  m$8 = null;var _iteratorNormalCompletion3 = true;
  var _didIteratorError3 = false;
  var _iteratorError3 = undefined;

  try {
    $7: for (var _iterator3 = items($it$10.options)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
      m$8 = _step3.value;
      var m$9 = undefined;var acc$1 = undefined;var temp$1 = undefined;var scope$6 = undefined;var bindings$1 = undefined;var t0$8 = undefined;var t1$2 = undefined;t0$8 = m$8;if (Array.isArray(t0$8) && (t1$2 = t0$8.length, t1$2 === 2)) {
        scope$6 = t0$8[0];bindings$1 = t0$8[1];acc$1 = [];temp$1 = null;m$9 = null;var _iteratorNormalCompletion4 = true;
        var _didIteratorError4 = false;
        var _iteratorError4 = undefined;

        try {
          $9: for (var _iterator4 = items(bindings$1)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
            m$9 = _step4.value;
            var $targ$13 = undefined;var $targ$12 = undefined;var k$1 = undefined;var v$1 = undefined;var t0$9 = undefined;var t1$3 = undefined;t0$9 = m$9;if (Array.isArray(t0$9) && (t1$3 = t0$9.length, t1$3 === 2)) {
              k$1 = t0$9[0];v$1 = t0$9[1];if (!send(send(e$1, "options", true), scope$6)) {
                $targ$13 = {};e$1.options[scope$6] = $targ$13;void 0;
              }$targ$12 = v$1;send(send(e$1, "options", true), scope$6)[k$1] = $targ$12;temp$1 = void 0;acc$1.push(temp$1);
            } else {
              ___match_error(m$9);
            }
          }
        } catch (err) {
          _didIteratorError4 = true;
          _iteratorError4 = err;
        } finally {
          try {
            if (!_iteratorNormalCompletion4 && _iterator4["return"]) {
              _iterator4["return"]();
            }
          } finally {
            if (_didIteratorError4) {
              throw _iteratorError4;
            }
          }
        }

        acc$1;
      } else {
        ___match_error(m$8);
      }
    }
  } catch (err) {
    _didIteratorError3 = true;
    _iteratorError3 = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion3 && _iterator3["return"]) {
        _iterator3["return"]();
      }
    } finally {
      if (_didIteratorError3) {
        throw _iteratorError3;
      }
    }
  }

  return e$1;
};Env$0.prototype.toString = function toString() {
  var $it$11 = undefined;var self$9 = undefined;$it$11 = this;self$9 = this;return "Env{...}";
};__amp____colon__(Env$0, __amp____colon__(($targ$14 = "Env", accum$2 = {}, accum$2["::name"] = $targ$14, accum$2), ($targ$15 = true, accum$3 = {}, accum$3["::egclass"] = $targ$15, accum$3)));track_location$0 = function track_location(f$0) {
  var f2$0 = undefined;f2$0 = function f2(context$0, scope$7, expr$1) {
    var rval$1 = undefined;var other$1 = undefined;var v$2 = undefined;var t0$10 = undefined;var m$10$0 = undefined;var rval$0 = undefined;rval$1 = false;try {
      rval$1 = f$0(context$0, scope$7, expr$1);rval$1;
    } catch (excv$0) {
      var e$2 = undefined;e$2 = excv$0;__lt____lt____colon__$0(e$2, expr$1);throw e$2;rval$1;
    }rval$0 = rval$1;m$10$0 = rval$0;if (Array.isArray(m$10$0) && (t0$10 = m$10$0.length, t0$10 === 2 && m$10$0[0] === "bounce")) {
      v$2 = m$10$0[1];return f2$0(context$0, scope$7, __lt____lt____colon__$0(v$2, expr$1));
    } else {
      other$1 = m$10$0;return __lt____lt____colon__$0(other$1, expr$1);
    }
  };return f2$0;
};Info$0 = function Info(temp$2$0, temp$3$0, temp$4$0, temp$5$0, temp$6$0) {
  var $targ$16 = undefined;var $it$12 = undefined;if (!getChecker(Info$0)(this)) {
    $it$12 = Object.create(Info$0.prototype);
  } else {
    $it$12 = this;
  }$it$12.context = temp$2$0;$it$12.scope = temp$3$0;$it$12.form = temp$4$0;$it$12.arg = temp$5$0;$it$12.expander = temp$6$0;$targ$16 = $it$12.form.env;$it$12.env = $targ$16;return $it$12;
};Info$0.prototype.gettext = function gettext(ph$0$0) {
  var location$0 = undefined;var t0$11 = undefined;var $it$13 = undefined;var self$10 = undefined;$it$13 = this;self$10 = this;t0$11 = ph$0$0;if (___hasprop(t0$11, "location")) {
    location$0 = t0$11.location;return location$0.text();
  } else {
    return null;
  }
};Info$0.prototype.raw = function raw(x$5) {
  var $it$14 = undefined;var self$11 = undefined;$it$14 = this;self$11 = this;return $it$14.gettext(x$5);
};Info$0.prototype.with_scope = function with_scope(newscope$0) {
  var $it$15 = undefined;var self$12 = undefined;$it$15 = this;self$12 = this;return Info$0($it$15.context, newscope$0, $it$15.form, $it$15.arg, $it$15.expander);
};Info$0.prototype.gensym = function gensym(name$4) {
  var $it$16 = undefined;var self$13 = undefined;$it$16 = this;self$13 = this;return $it$16.expander.gensym(name$4 || "");
};Info$0.prototype.defer = function defer() {
  var $it$17 = undefined;var self$14 = undefined;$it$17 = this;self$14 = this;return ["nostep", $it$17.form];
};Info$0.prototype.mkenv = function mkenv() {
  var $it$18 = undefined;var self$15 = undefined;$it$18 = this;self$15 = this;return $it$18.expander.mkenv();
};Info$0.prototype.mark = function mark() {
  var m$12 = undefined;var acc$2 = undefined;var temp$7 = undefined;var xs$0 = undefined;var x$6 = undefined;var t0$13 = undefined;var t1$4 = undefined;var ph$2$0 = undefined;var t0$12 = undefined;var m$11$0 = undefined;var $it$19 = undefined;var self$16 = undefined;$it$19 = this;self$16 = this;m$11$0 = arguments;t0$12 = m$11$0.length;if (t0$12 >= 0) {
    ph$2$0 = Array.prototype.slice.call(m$11$0, 0);t0$13 = ph$2$0;t1$4 = t0$13.length;if (t1$4 === 1) {
      x$6 = t0$13[0];return $it$19.env.mark(x$6);
    } else {
      xs$0 = ph$2$0;acc$2 = [];temp$7 = null;m$12 = null;var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        $10: for (var _iterator = xs$0[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          m$12 = _step.value;
          var x$7 = undefined;x$7 = m$12;temp$7 = $it$19.env.mark(x$7);acc$2.push(temp$7);
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator["return"]) {
            _iterator["return"]();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      return acc$2;
    }
  } else {
    return ___match_error(m$11$0, "{*match}");
  }
};Info$0.prototype.step = function step(context$1, expr$2) {
  var $it$20 = undefined;var self$17 = undefined;$it$20 = this;self$17 = this;return $it$20.expander.step(context$1, $it$20.scope, expr$2);
};Info$0.prototype.step_all = function step_all(context$2, exprs$0) {
  var $it$21 = undefined;var self$18 = undefined;$it$21 = this;self$18 = this;return $it$21.expander.step_all(context$2, $it$21.scope, exprs$0);
};Info$0.prototype.expand = function expand(context$3, expr$3) {
  var $it$22 = undefined;var self$19 = undefined;$it$22 = this;self$19 = this;return $it$22.expander.expand(context$3, $it$22.scope, expr$3);
};Info$0.prototype.go = function go(x$8, start$0, end$0) {
  var $it$23 = undefined;var self$20 = undefined;$it$23 = this;self$20 = this;return $it$23.expander.pipeline.go(x$8, start$0, end$0);
};Info$0.prototype.getopt = function getopt(name$5) {
  var $it$24 = undefined;var self$21 = undefined;$it$24 = this;self$21 = this;return $it$24.env.getopt($it$24.scope, name$5);
};Info$0.prototype.setopt = function setopt(name$6, value$2) {
  var $it$25 = undefined;var self$22 = undefined;$it$25 = this;self$22 = this;return $it$25.env.setopt($it$25.scope, name$6, value$2);
};__amp____colon__(Info$0, __amp____colon__(($targ$17 = "Info", accum$4 = {}, accum$4["::name"] = $targ$17, accum$4), ($targ$18 = true, accum$5 = {}, accum$5["::egclass"] = $targ$18, accum$5)));Expander$0 = function Expander(temp$8$0, temp$9$0, temp$10$0) {
  var m$13 = undefined;var acc$3 = undefined;var temp$11 = undefined;var $targ$19 = undefined;var $it$26 = undefined;if (!getChecker(Expander$0)(this)) {
    $it$26 = Object.create(Expander$0.prototype);
  } else {
    $it$26 = this;
  }$it$26.stdenv = temp$8$0;$it$26.generic_nodes = temp$9$0;$it$26.pipeline = temp$10$0;$targ$19 = object((acc$3 = [], temp$11 = null, m$13 = null, (function () {
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
      $11: for (var _iterator = jsKeywords$0[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
        m$13 = _step.value;
        var kw$0 = undefined;kw$0 = m$13;temp$11 = [kw$0, 0];acc$3.push(temp$11);
      }
    } catch (err) {
      _didIteratorError = true;
      _iteratorError = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion && _iterator["return"]) {
          _iterator["return"]();
        }
      } finally {
        if (_didIteratorError) {
          throw _iteratorError;
        }
      }
    }
  })(), acc$3));$it$26.nameusage = $targ$19;return $it$26;
};Expander$0.prototype.gensym = function gensym(temp$12$0) {
  var t0$14 = undefined;var idx$0 = undefined;var $targ$20 = undefined;var $$2295$0 = undefined;var bridge$$2292$0 = undefined;var name$7 = undefined;var ph$3$0 = undefined;var $it$27 = undefined;var self$23 = undefined;$it$27 = this;self$23 = this;t0$14 = temp$12$0;name$7 = t0$14;ph$3$0 = t0$14;bridge$$2292$0 = ph$3$0;if (bridge$$2292$0 === void 0 || bridge$$2292$0 === null) {
    return $it$27.gensym("");
  } else {
    if (Object.prototype.hasOwnProperty.call($it$27.nameusage, name$7)) {
      idx$0 = $it$27.nameusage[name$7] = send(send($it$27, "nameusage", true), name$7) + 1;return name$7 + "$" + String(idx$0);
    } else {
      $targ$20 = 0;$it$27.nameusage[name$7] = $targ$20;return name$7 + "$0";
    }
  }
};Expander$0.prototype.mkenv = function mkenv() {
  var e$3 = undefined;var $targ$21 = undefined;var $it$28 = undefined;var self$24 = undefined;$it$28 = this;self$24 = this;e$3 = Env$0();$targ$21 = $it$28.stdenv.scopes.top;e$3.scopes.top = $targ$21;return e$3;
};Expander$0.prototype.run_macro = function run_macro(m$14, context$4, scope$8, form$0, arg$1) {
  var rval$3 = undefined;var rval$4 = undefined;var info$0 = undefined;var rval$2 = undefined;var $it$29 = undefined;var self$25 = undefined;$it$29 = this;self$25 = this;info$0 = Info$0(context$4, scope$8, form$0, arg$1, $it$29);rval$3 = false;try {
    rval$3 = m$14(context$4, info$0, form$0, arg$1);rval$3;
  } catch (excv$1) {
    (function () {
      var t0$16 = undefined;var t1$6 = undefined;var t2$1 = undefined;var bridge$$2430$0 = undefined;var msg$0 = undefined;var msg$2 = undefined;var find$0 = undefined;var err$0 = undefined;var other$2 = undefined;var m$15$0 = undefined;var $targ$22 = undefined;var name$8 = undefined;var e$4 = undefined;var e$5 = undefined;var value$3 = undefined;var t0$15 = undefined;var t1$5 = undefined;var t2$0 = undefined;var t3$0 = undefined;t0$15 = excv$1;if (getChecker(ErrorFactory(["match"]))(t0$15) && (___hasprop(t0$15, "args") && (t1$5 = t0$15.args, Array.isArray(t1$5) && (t2$0 = t1$5.length, t2$0 === 1 && (t3$0 = t1$5[0], ___hasprop(t3$0, "value")))))) {
        value$3 = t3$0.value;$targ$22 = form$0;bridge$$2430$0 = $targ$22;if (Array.isArray(bridge$$2430$0) && (t0$16 = bridge$$2430$0.length, t0$16 === 3 && (bridge$$2430$0[0] === "send" && (t1$6 = bridge$$2430$0[1], Array.isArray(t1$6) && (t2$1 = t1$6.length, t2$1 === 2 && (t1$6[0] === "symbol" && (name$8 = t1$6[1], bridge$$2430$0[2], true)))))) || (name$8 = "<unknown>", true)) {} else {
          ___match_error($targ$22, "#send{#symbol{name}, _} or name is \"<unknown>\"");
        }m$15$0 = value$3;if (m$15$0 === context$4) {
          msg$0 = ENode([], {}, ["The macro cannot be found in context {", context$4, "}."]).toString();e$4 = ErrorFactory(["syntax", "context"]).create(msg$0, { context: context$4, form: form$0 });
        } else {
          other$2 = m$15$0;find$0 = function find(temp$13$0) {
            var t0$17 = undefined;var msg$1 = undefined;var m$16 = undefined;var other$3 = undefined;var type$1 = undefined;var xs$1 = undefined;var t0$18 = undefined;var t1$7 = undefined;var arg$2 = undefined;var ph$4$0 = undefined;t0$17 = temp$13$0;arg$2 = t0$17;ph$4$0 = t0$17;if (ph$4$0 === value$3) {
              msg$1 = ENode([], {}, ["The macro `", name$8, "` expected something different. You should bug the macro/language implementer to improve their error messages."]).toString();return ErrorFactory(["syntax", "argument"]).create(msg$1, { context: context$4, argument: arg$2, form: form$0 });
            } else {
              t0$18 = ph$4$0;t1$7 = t0$18.length;if (t1$7 >= 1) {
                type$1 = t0$18[0];xs$1 = Array.prototype.slice.call(t0$18, 1);m$16 = null;var _iteratorNormalCompletion = true;
                var _didIteratorError = false;
                var _iteratorError = undefined;

                try {
                  $12: for (var _iterator = xs$1[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                    m$16 = _step.value;
                    var x$9 = undefined;var t0$19 = undefined;t0$19 = getProjector(find$0)(m$16);if (t0$19[0]) {
                      x$9 = t0$19[1];if (x$9) {
                        return x$9;
                      }
                    } else {
                      ___match_error(m$16);
                    }
                  }
                } catch (err) {
                  _didIteratorError = true;
                  _iteratorError = err;
                } finally {
                  try {
                    if (!_iteratorNormalCompletion && _iterator["return"]) {
                      _iterator["return"]();
                    }
                  } finally {
                    if (_didIteratorError) {
                      throw _iteratorError;
                    }
                  }
                }

                return false;
              } else {
                other$3 = ph$4$0;return false;
              }
            }
          };err$0 = find$0(arg$1);if (err$0) {
            e$4 = err$0;
          } else {
            msg$2 = ENode([], {}, ["An error occurred in the `", name$8, "` macro. You should bug the macro/language implementer to fix this."]).toString();e$4 = ErrorFactory(["syntax", "failure"]).create(msg$2, { form: form$0, value: value$3 });
          }
        }throw e$4;rval$3;
      } else {
        e$5 = excv$1;throw e$5;rval$3;
      }
    })();
  }rval$2 = rval$3;rval$4 = false;try {
    rval$4 = $it$29.mkenv().mark(rval$2);rval$4;
  } catch (excv$2) {
    var t$0 = undefined;var e$6 = undefined;e$6 = excv$2;t$0 = rval$2;console.log(t$0);throw ErrorFactory(["syntax", "macro"]).create("Macro returned a bad node", { form: form$0 });rval$4;
  }return rval$4;
};Expander$0.prototype.step = function step(context$5, scope$9, expr$4) {
  var t0$26 = undefined;var $targ$23 = undefined;var helper$0 = undefined;var $it$30 = undefined;var self$26 = undefined;$it$30 = this;self$26 = this;$targ$23 = function (context$6, scope$10, temp$14$0) {
    var t0$20 = undefined;var other$4 = undefined;var env$1 = undefined;var m$18$0 = undefined;var other$5 = undefined;var t0$23 = undefined;var m$20$0 = undefined;var other$6 = undefined;var m$19 = undefined;var t0$22 = undefined;var m$17$0 = undefined;var env$0 = undefined;var other$7 = undefined;var t0$24 = undefined;var m$22$0 = undefined;var other$8 = undefined;var m$24 = undefined;var t0$25 = undefined;var m$23$0 = undefined;var t$1 = undefined;var p$0 = undefined;var other$9 = undefined;var x$10 = undefined;var code$0 = undefined;var url$0 = undefined;var f$1 = undefined;var arg$3 = undefined;var m$21 = undefined;var s$2 = undefined;var $$2607$0 = undefined;var $$2608$0 = undefined;var $$2609$0 = undefined;var t0$21 = undefined;var t1$8 = undefined;var expr$5 = undefined;var ph$5$0 = undefined;t0$20 = temp$14$0;expr$5 = t0$20;ph$5$0 = t0$20;t0$21 = ph$5$0;t1$8 = t0$21.length;if (($$2609$0 = t1$8 === 2) && t0$21[0] === "symbol") {
      s$2 = t0$21[1];m$18$0 = expr$5;if (___hasprop(m$18$0, "env")) {
        env$1 = m$18$0.env;env$0 = expr$5.env;
      } else {
        other$4 = m$18$0;throw ErrorFactory(["syntax", "no_env"]).create("No environment was found to resolve '" + s$2 + "'", { symbol: expr$5 });
      }m$17$0 = env$0.resolve(scope$10, s$2, expr$5.level || 0);if (Array.isArray(m$17$0) && (t0$22 = m$17$0.length, t0$22 === 2 && m$17$0[0] === "macro")) {
        m$19 = m$17$0[1];m$20$0 = context$6;if (Array.isArray(m$20$0) && (t0$23 = m$20$0.length, t0$23 === 2 && (m$20$0[0] === "expr" && m$20$0[1] === "head"))) {
          return ["macro", m$19];
        } else {
          other$5 = m$20$0;return ["bounce", $it$30.run_macro(m$19, context$6, scope$10, expr$5, __lt____lt____colon__$0(["void"], expr$5))];
        }
      } else {
        other$6 = m$17$0;return expr$5;
      }
    } else {
      if ($$2609$0 && t0$21[0] === "macro") {
        m$21 = t0$21[1];m$22$0 = context$6;if (Array.isArray(m$22$0) && (t0$24 = m$22$0.length, t0$24 === 2 && (m$22$0[0] === "expr" && m$22$0[1] === "head"))) {
          return expr$5;
        } else {
          other$7 = m$22$0;return ["bounce", $it$30.run_macro(m$21, context$6, scope$10, expr$5, __lt____lt____colon__$0(["void"], expr$5))];
        }
      } else {
        if (t1$8 === 3 && t0$21[0] === "send") {
          f$1 = t0$21[1];arg$3 = t0$21[2];m$23$0 = helper$0(["expr", "head"], scope$10, f$1);if (Array.isArray(m$23$0) && (t0$25 = m$23$0.length, t0$25 === 2 && m$23$0[0] === "macro")) {
            m$24 = m$23$0[1];return ["bounce", $it$30.run_macro(m$24, context$6, scope$10, expr$5, arg$3)];
          } else {
            other$8 = m$23$0;return expr$5;
          }
        } else {
          if (t1$8 >= 2 && t1$8 <= 3 && t0$21[0] === "parse") {
            code$0 = t0$21[1];if (2 >= t1$8) {
              url$0 = null;
            } else {
              url$0 = t0$21[2];
            }t$1 = tokenize$0(Source$0(code$0, url$0));p$0 = parse$0(t$1);return ["bounce", helper$0(context$6, scope$10, expr$5.env.mark(p$0))];
          } else {
            if (t1$8 === 2 && t0$21[0] === "nostep") {
              x$10 = t0$21[1];return x$10;
            } else {
              other$9 = ph$5$0;return expr$5;
            }
          }
        }
      }
    }
  };t0$26 = getProjector(track_location$0)($targ$23);if (t0$26[0]) {
    helper$0 = t0$26[1];
  } else {
    ___match_error($targ$23, "track_location! helper{context, scope, match expr}");
  }return helper$0(context$5, scope$9, expr$4);
};Expander$0.prototype.step_all = function step_all(context$7, scope$11, temp$15$0) {
  var t0$27 = undefined;var t1$9 = undefined;var pre$0 = undefined;var bulk$0 = undefined;var post$0 = undefined;var stmts$0 = undefined;var $it$31 = undefined;var self$27 = undefined;$it$31 = this;self$27 = this;t0$27 = temp$15$0;if (Array.isArray(t0$27) && (t1$9 = t0$27.length, t1$9 >= 0)) {
    stmts$0 = Array.prototype.slice.call(t0$27, 0);
  } else {
    ___match_error(temp$15$0);
  }pre$0 = [];bulk$0 = [];post$0 = [];$13: while (stmts$0.length) {
    var m$27 = undefined;var acc$4 = undefined;var temp$16 = undefined;var e$7 = undefined;var x$11 = undefined;var m$26 = undefined;var stmt$1 = undefined;var stmt$0 = undefined;var prepend$0 = undefined;var $$2807$0 = undefined;var $$2808$0 = undefined;var $$2809$0 = undefined;var t0$28 = undefined;var m$25$0 = undefined;var current$0 = undefined;current$0 = stmts$0.shift();m$25$0 = $it$31.step(context$7, scope$11, current$0);if (($$2807$0 = Array.isArray(m$25$0)) && (t0$28 = m$25$0.length, t0$28 >= 1 && m$25$0[0] === "splice")) {
      prepend$0 = Array.prototype.slice.call(m$25$0, 1);stmts$0 = prepend$0.concat(stmts$0);stmts$0;
    } else {
      if ($$2807$0 && (($$2809$0 = t0$28 === 2) && m$25$0[0] === "float")) {
        stmt$0 = m$25$0[1];pre$0 = pre$0.concat($it$31.step_all(context$7, scope$11, [stmt$0]));
      } else {
        if ($$2809$0 && m$25$0[0] === "sink") {
          stmt$1 = m$25$0[1];post$0 = post$0.concat($it$31.step_all(context$7, scope$11, [stmt$1]));
        } else {
          if ($$2809$0 && m$25$0[0] === "restmacro") {
            m$26 = m$25$0[1];e$7 = $it$31.mkenv();acc$4 = [];temp$16 = null;m$27 = null;var _iteratorNormalCompletion = true;
            var _didIteratorError = false;
            var _iteratorError = undefined;

            try {
              $14: for (var _iterator = m$26(stmts$0)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                m$27 = _step.value;
                var stmt$2 = undefined;stmt$2 = m$27;temp$16 = e$7.mark(stmt$2);acc$4.push(temp$16);
              }
            } catch (err) {
              _didIteratorError = true;
              _iteratorError = err;
            } finally {
              try {
                if (!_iteratorNormalCompletion && _iterator["return"]) {
                  _iterator["return"]();
                }
              } finally {
                if (_didIteratorError) {
                  throw _iteratorError;
                }
              }
            }

            stmts$0 = acc$4;stmts$0;
          } else {
            x$11 = m$25$0;bulk$0.push(x$11);
          }
        }
      }
    }
  }return pre$0.concat(bulk$0).concat(post$0);
};Expander$0.prototype.expand = function expand(context$8, scope$12, expr$6) {
  var t0$48 = undefined;var $targ$24 = undefined;var helper$1 = undefined;var $it$32 = undefined;var self$28 = undefined;$it$32 = this;self$28 = this;$targ$24 = function (context$9, scope$13, expr$7) {
    var t0$30 = undefined;var v$3 = undefined;var resolved$0 = undefined;var m$29$0 = undefined;var $targ$25 = undefined;var env$2 = undefined;var m$30 = undefined;var acc$5 = undefined;var temp$17 = undefined;var newargs$0 = undefined;var m$31 = undefined;var acc$6 = undefined;var temp$18 = undefined;var newargs$1 = undefined;var t0$32 = undefined;var newscope$1 = undefined;var $targ$26 = undefined;var env$3 = undefined;var m$32 = undefined;var acc$7 = undefined;var temp$19 = undefined;var t0$37 = undefined;var newscope$2 = undefined;var stepscope$0 = undefined;var changes$0 = undefined;var $targ$27 = undefined;var newargs$2 = undefined;var vars$0 = undefined;var exp$0 = undefined;var m$38 = undefined;var f$3 = undefined;var f$4 = undefined;var other$14 = undefined;var t0$42 = undefined;var m$39$0 = undefined;var obj$0 = undefined;var arr$0 = undefined;var arr_parts$0 = undefined;var obj_parts$0 = undefined;var index$0 = undefined;var objindex$0 = undefined;var new_arr_part$0 = undefined;var decl_obj$0 = undefined;var new_obj_part$0 = undefined;var is_obj$0 = undefined;var r$0 = undefined;var x$14 = undefined;var msg$5 = undefined;var $targ$31 = undefined;var otherwise$0 = undefined;var m$41 = undefined;var t0$43 = undefined;var m$40$0 = undefined;var t$2 = undefined;var orig$0 = undefined;var m$42 = undefined;var acc$10 = undefined;var temp$22 = undefined;var newscope$3 = undefined;var s$9 = undefined;var newscope$4 = undefined;var name$9 = undefined;var t0$46 = undefined;var m$43 = undefined;var acc$11 = undefined;var temp$23 = undefined;var m$44 = undefined;var acc$12 = undefined;var temp$24 = undefined;var tokens$0 = undefined;var msg$6 = undefined;var other$16 = undefined;var c$0 = undefined;var ops$0 = undefined;var args$8 = undefined;var type$2 = undefined;var args$7 = undefined;var x$17 = undefined;var tag$0 = undefined;var body$2 = undefined;var ph$6$0 = undefined;var x$16 = undefined;var bindings$2 = undefined;var body$1 = undefined;var generator$0 = undefined;var target$0 = undefined;var value$8 = undefined;var args$6 = undefined;var args$5 = undefined;var args$4 = undefined;var args$3 = undefined;var variable$0 = undefined;var s$4 = undefined;var value$4 = undefined;var body$0 = undefined;var args$2 = undefined;var args$1 = undefined;var f$2 = undefined;var arg$4 = undefined;var s$3 = undefined;var $$2920$0 = undefined;var $$2921$0 = undefined;var $$2922$0 = undefined;var t0$29 = undefined;var t1$10 = undefined;var t2$2 = undefined;var m$28$0 = undefined;expr$7 = $it$32.step(context$9, scope$13, expr$7);m$28$0 = expr$7;if (($$2920$0 = Array.isArray(m$28$0)) && (t0$29 = m$28$0.length, ($$2922$0 = t0$29 === 2) && m$28$0[0] === "symbol")) {
      s$3 = m$28$0[1];$targ$25 = expr$7;t0$30 = $targ$25;if (___hasprop(t0$30, "env")) {
        env$2 = t0$30.env;
      } else {
        ___match_error($targ$25, "{=> env}");
      }m$29$0 = env$2.resolve(scope$13, s$3, expr$7.level || 0);if (m$29$0 === void 0) {
        throw ErrorFactory(["syntax", "undeclared"]).create("Undeclared variable: " + s$3, { node: expr$7 });
      } else {
        resolved$0 = m$29$0;v$3 = __amp____colon__(clone(resolved$0), { location: expr$7.location, top: resolved$0.top, origin: resolved$0 });return ["bounce", v$3];
      }
    } else {
      if ($$2922$0 && m$28$0[0] === "value") {
        m$28$0[1];return expr$7;
      } else {
        if ($$2922$0 && m$28$0[0] === "variable") {
          m$28$0[1];return expr$7;
        } else {
          if ($$2920$0 && (t0$29 === 1 && m$28$0[0] === "void")) {
            return expr$7;
          } else {
            if ($$2920$0 && (t0$29 === 3 && m$28$0[0] === "send")) {
              f$2 = m$28$0[1];arg$4 = m$28$0[2];return ["send", helper$1(["expr", "head"], scope$13, f$2), helper$1(["expr", "tail"], scope$13, arg$4)];
            } else {
              if ($$2920$0 && (($$2922$0 = t0$29 >= 1) && m$28$0[0] === "array")) {
                args$1 = Array.prototype.slice.call(m$28$0, 1);acc$5 = [];temp$17 = null;m$30 = null;var _iteratorNormalCompletion = true;
                var _didIteratorError = false;
                var _iteratorError = undefined;

                try {
                  $15: for (var _iterator = $it$32.step_all(["expr", "array"], scope$13, args$1)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                    m$30 = _step.value;
                    var arg$5 = undefined;arg$5 = m$30;temp$17 = helper$1(["expr", "expr"], scope$13, arg$5);acc$5.push(temp$17);
                  }
                } catch (err) {
                  _didIteratorError = true;
                  _iteratorError = err;
                } finally {
                  try {
                    if (!_iteratorNormalCompletion && _iterator["return"]) {
                      _iterator["return"]();
                    }
                  } finally {
                    if (_didIteratorError) {
                      throw _iteratorError;
                    }
                  }
                }

                newargs$0 = acc$5;return ["array"].concat(newargs$0);
              } else {
                if ($$2922$0 && m$28$0[0] === "object") {
                  args$2 = Array.prototype.slice.call(m$28$0, 1);acc$6 = [];temp$18 = null;m$31 = null;var _iteratorNormalCompletion2 = true;
                  var _didIteratorError2 = false;
                  var _iteratorError2 = undefined;

                  try {
                    $16: for (var _iterator2 = $it$32.step_all(["expr", "object"], scope$13, args$2)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
                      m$31 = _step2.value;
                      var k$2 = undefined;var v$4 = undefined;var t0$31 = undefined;var t1$11 = undefined;t0$31 = m$31;if (Array.isArray(t0$31) && (t1$11 = t0$31.length, t1$11 === 3 && t0$31[0] === "array")) {
                        k$2 = t0$31[1];v$4 = t0$31[2];temp$18 = ["array", helper$1(["expr", "expr"], scope$13, k$2), helper$1(["expr", "expr"], scope$13, v$4)];acc$6.push(temp$18);
                      } else {
                        ___match_error(m$31);
                      }
                    }
                  } catch (err) {
                    _didIteratorError2 = true;
                    _iteratorError2 = err;
                  } finally {
                    try {
                      if (!_iteratorNormalCompletion2 && _iterator2["return"]) {
                        _iterator2["return"]();
                      }
                    } finally {
                      if (_didIteratorError2) {
                        throw _iteratorError2;
                      }
                    }
                  }

                  newargs$1 = acc$6;return ["object"].concat(newargs$1);
                } else {
                  if ($$2920$0 && (t0$29 === 4 && (m$28$0[0] === "bind" && (t1$10 = m$28$0[1], variable$0 = t1$10, Array.isArray(t1$10) && (t2$2 = t1$10.length, t2$2 === 2 && t1$10[0] === "symbol"))))) {
                    s$4 = t1$10[1];value$4 = m$28$0[2];body$0 = m$28$0[3];newscope$1 = Scope$0(scope$13);$targ$26 = variable$0;t0$32 = $targ$26;if (___hasprop(t0$32, "env")) {
                      env$3 = t0$32.env;
                    } else {
                      ___match_error($targ$26, "{=> env}");
                    }env$3.bind(newscope$1, s$4, value$4);return helper$1(context$9, newscope$1, body$0);
                  } else {
                    if ($$2920$0 && (($$2922$0 = t0$29 >= 1) && m$28$0[0] === "splice")) {
                      args$3 = Array.prototype.slice.call(m$28$0, 1);return ["bounce", __amp____colon__(["multi"].concat(args$3), { override_scope: true })];
                    } else {
                      if ($$2922$0 && m$28$0[0] === "interactive") {
                        args$4 = Array.prototype.slice.call(m$28$0, 1);return ["bounce", __amp____colon__(["multi"].concat(args$4), { override_scope: true, all_mutable: true })];
                      } else {
                        if ($$2922$0 && m$28$0[0] === "multi") {
                          args$5 = Array.prototype.slice.call(m$28$0, 1);if (expr$7.override_scope) {
                            newscope$2 = scope$13;
                          } else {
                            newscope$2 = Scope$0(scope$13);
                          }if (expr$7.nonrecursive) {
                            stepscope$0 = scope$13;
                          } else {
                            stepscope$0 = newscope$2;
                          }changes$0 = false;$targ$27 = classify$0("newargs", "vars", (acc$7 = [], temp$19 = null, m$32 = null, (function () {
                            var _iteratorNormalCompletion3 = true;
                            var _didIteratorError3 = false;
                            var _iteratorError3 = undefined;

                            try {
                              $17: for (var _iterator3 = $it$32.step_all(["expr", "multi"], stepscope$0, args$5)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
                                m$32 = _step3.value;
                                var t0$34 = undefined;var $targ$28 = undefined;var env$4 = undefined;var t0$35 = undefined;var v$5 = undefined;var $targ$29 = undefined;var env$5 = undefined;var t0$36 = undefined;var $targ$30 = undefined;var env$6 = undefined;var other$10 = undefined;var s$7 = undefined;var variable$3 = undefined;var v$6 = undefined;var value$7 = undefined;var variable$2 = undefined;var s$6 = undefined;var value$6 = undefined;var variable$1 = undefined;var s$5 = undefined;var value$5 = undefined;var $$3116$0 = undefined;var $$3117$0 = undefined;var $$3118$0 = undefined;var $$3119$0 = undefined;var $$3120$0 = undefined;var $$3121$0 = undefined;var t0$33 = undefined;var t1$12 = undefined;var t2$3 = undefined;var t3$1 = undefined;t0$33 = m$32;if (($$3117$0 = Array.isArray(t0$33)) && (t1$12 = t0$33.length, t1$12 === 3 && (t0$33[0] === "declare_raw" && (t2$3 = t0$33[1], variable$1 = t2$3, Array.isArray(t2$3) && (t3$1 = t2$3.length, t3$1 === 2 && t2$3[0] === "symbol"))))) {
                                  s$5 = t2$3[1];value$5 = t0$33[2];$targ$28 = variable$1;t0$34 = $targ$28;if (___hasprop(t0$34, "env")) {
                                    env$4 = t0$34.env;
                                  } else {
                                    ___match_error($targ$28, "{=> env}");
                                  }env$4.bind(newscope$2, s$5, value$5);changes$0 = true;temp$19 = ["ignore"];acc$7.push(temp$19);
                                } else {
                                  if ($$3117$0 && (($$3119$0 = t1$12 >= 2 && t1$12 <= 3) && (($$3120$0 = t0$33[0] === "declare") && (t2$3 = t0$33[1], variable$2 = t2$3, Array.isArray(t2$3) && (t3$1 = t2$3.length, t3$1 === 2 && t2$3[0] === "symbol"))))) {
                                    s$6 = t2$3[1];if (2 >= t1$12) {
                                      value$6 = null;
                                    } else {
                                      value$6 = t0$33[2];
                                    }$targ$29 = variable$2;t0$35 = $targ$29;if (___hasprop(t0$35, "env")) {
                                      env$5 = t0$35.env;
                                    } else {
                                      ___match_error($targ$29, "{=> env}");
                                    }if (variable$2.use_previous && env$5.resolve(newscope$2, s$6, variable$2.level || 0)) {
                                      temp$19 = ["splice"];
                                    } else {
                                      v$5 = __lt____lt____colon__$0(["variable", $it$32.gensym(s$6)], variable$2);__amp____colon__(v$5, { mutable: expr$7.all_mutable || variable$2.mutable });__amp____colon__(v$5, { top: variable$2.top });env$5.bind(newscope$2, s$6, v$5);changes$0 = true;if (value$6) {
                                        temp$19 = ["splice", ["newargs", ["assign", v$5, value$6]], ["vars", v$5]];
                                      } else {
                                        temp$19 = ["vars", v$5];
                                      }
                                    }acc$7.push(temp$19);
                                  } else {
                                    if ($$3120$0 && (v$6 = t2$3, Array.isArray(t2$3) && (t3$1 = t2$3.length, t3$1 === 2 && t2$3[0] === "variable"))) {
                                      t2$3[1];if (2 >= t1$12) {
                                        value$7 = null;
                                      } else {
                                        value$7 = t0$33[2];
                                      }changes$0 = true;if (value$7) {
                                        temp$19 = ["splice", ["newargs", ["assign", v$6, value$7]], ["vars", v$6]];
                                      } else {
                                        temp$19 = ["vars", v$6];
                                      }acc$7.push(temp$19);
                                    } else {
                                      if ($$3117$0 && (t1$12 === 2 && (t0$33[0] === "undeclare" && (t2$3 = t0$33[1], Array.isArray(t2$3) && (t3$1 = t2$3.length, t3$1 === 2 && t2$3[0] === "symbol"))))) {
                                        s$7 = t2$3[1];variable$3 = t2$3;$targ$30 = variable$3;t0$36 = $targ$30;if (___hasprop(t0$36, "env")) {
                                          env$6 = t0$36.env;
                                        } else {
                                          ___match_error($targ$30, "{=> env}");
                                        }env$6.bind(newscope$2, s$7, undefined);changes$0 = true;temp$19 = ["ignore"];acc$7.push(temp$19);
                                      } else {
                                        other$10 = m$32;temp$19 = ["newargs", other$10];acc$7.push(temp$19);
                                      }
                                    }
                                  }
                                }
                              }
                            } catch (err) {
                              _didIteratorError3 = true;
                              _iteratorError3 = err;
                            } finally {
                              try {
                                if (!_iteratorNormalCompletion3 && _iterator3["return"]) {
                                  _iterator3["return"]();
                                }
                              } finally {
                                if (_didIteratorError3) {
                                  throw _iteratorError3;
                                }
                              }
                            }
                          })(), acc$7));t0$37 = $targ$27;if (___hasprop(t0$37, "newargs") && (newargs$2 = t0$37.newargs, ___hasprop(t0$37, "vars"))) {
                            vars$0 = t0$37.vars;
                          } else {
                            ___match_error($targ$27, "{=> newargs, => vars}");
                          }[newargs$2, vars$0];exp$0 = function exp(s$8) {
                            var m$33 = undefined;var acc$8 = undefined;var temp$20 = undefined;var m$34 = undefined;var acc$9 = undefined;var temp$21 = undefined;var stepped$0 = undefined;acc$8 = [];temp$20 = null;m$33 = null;var _iteratorNormalCompletion3 = true;
                            var _didIteratorError3 = false;
                            var _iteratorError3 = undefined;

                            try {
                              $19: for (var _iterator3 = enumerate(newargs$2)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
                                m$33 = _step3.value;
                                var e$8 = undefined;var i$0 = undefined;var arg$6 = undefined;var t0$38 = undefined;var t1$13 = undefined;t0$38 = m$33;if (Array.isArray(t0$38) && (t1$13 = t0$38.length, t1$13 === 2)) {
                                  i$0 = t0$38[0];arg$6 = t0$38[1];if (i$0 === newargs$2.length - 1) {
                                    e$8 = "expr";
                                  } else {
                                    e$8 = "ignore";
                                  }temp$20 = $it$32.step(["expr", e$8], s$8, arg$6);acc$8.push(temp$20);
                                } else {
                                  ___match_error(m$33);
                                }
                              }
                            } catch (err) {
                              _didIteratorError3 = true;
                              _iteratorError3 = err;
                            } finally {
                              try {
                                if (!_iteratorNormalCompletion3 && _iterator3["return"]) {
                                  _iterator3["return"]();
                                }
                              } finally {
                                if (_didIteratorError3) {
                                  throw _iteratorError3;
                                }
                              }
                            }

                            stepped$0 = acc$8;acc$9 = [];temp$21 = null;m$34 = null;var _iteratorNormalCompletion4 = true;
                            var _didIteratorError4 = false;
                            var _iteratorError4 = undefined;

                            try {
                              $18: for (var _iterator4 = stepped$0[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
                                m$34 = _step4.value;
                                var arg$7 = undefined;arg$7 = m$34;temp$21 = helper$1(["expr", "expr"], s$8, arg$7);acc$9.push(temp$21);
                              }
                            } catch (err) {
                              _didIteratorError4 = true;
                              _iteratorError4 = err;
                            } finally {
                              try {
                                if (!_iteratorNormalCompletion4 && _iterator4["return"]) {
                                  _iterator4["return"]();
                                }
                              } finally {
                                if (_didIteratorError4) {
                                  throw _iteratorError4;
                                }
                              }
                            }

                            return acc$9;
                          };if (changes$0) {
                            return ["scope", vars$0, ["multi"].concat(exp$0(newscope$2))];
                          } else {
                            return ["multi"].concat(exp$0(scope$13));
                          }
                        } else {
                          if ($$2922$0 && m$28$0[0] === "data") {
                            args$6 = Array.prototype.slice.call(m$28$0, 1);obj$0 = ["object"];arr$0 = ["array"];arr_parts$0 = [];obj_parts$0 = [];index$0 = 0;objindex$0 = null;new_arr_part$0 = function new_arr_part() {
                              var other$11 = undefined;var t0$39 = undefined;var m$35$0 = undefined;m$35$0 = arr$0;if (Array.isArray(m$35$0) && (t0$39 = m$35$0.length, t0$39 === 1 && m$35$0[0] === "array")) {
                                return false;
                              } else {
                                other$11 = m$35$0;arr_parts$0.push(arr$0);arr$0 = ["array"];return arr$0;
                              }
                            };decl_obj$0 = function decl_obj() {
                              var msg$3 = undefined;var msg$4 = undefined;var m$36$0 = undefined;m$36$0 = objindex$0;if (equal(index$0, null)) {
                                msg$3 = "Object fields cannot be declared after *rest arguments.";throw ErrorFactory(["syntax", "illegal_object"]).create(msg$3, { node: expr$7 });
                              } else {
                                if (equal(m$36$0, null)) {
                                  objindex$0 = index$0;return objindex$0;
                                } else {
                                  if (equal(m$36$0, index$0)) {
                                    return undefined;
                                  } else {
                                    msg$4 = "Cannot declare object fields at multiple indexes.";throw ErrorFactory(["syntax", "illegal_object"]).create(msg$4, { node: expr$7 });
                                  }
                                }
                              }
                            };new_obj_part$0 = function new_obj_part() {
                              var other$12 = undefined;var t0$40 = undefined;var m$37$0 = undefined;m$37$0 = obj$0;if (Array.isArray(m$37$0) && (t0$40 = m$37$0.length, t0$40 === 1 && m$37$0[0] === "object")) {
                                return false;
                              } else {
                                other$12 = m$37$0;obj_parts$0.push(obj$0);obj$0 = ["object"];return obj$0;
                              }
                            };m$38 = null;var _iteratorNormalCompletion3 = true;
                            var _didIteratorError3 = false;
                            var _iteratorError3 = undefined;

                            try {
                              $20: for (var _iterator3 = $it$32.step_all(["expr", "data"], scope$13, args$6)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
                                m$38 = _step3.value;
                                var other$13 = undefined;var expr$9 = undefined;var expr$8 = undefined;var k$3 = undefined;var v$7 = undefined;var $$3387$0 = undefined;var $$3388$0 = undefined;var $$3389$0 = undefined;var $$3390$0 = undefined;var t0$41 = undefined;var t1$14 = undefined;t0$41 = m$38;if (($$3388$0 = Array.isArray(t0$41)) && (t1$14 = t0$41.length, t1$14 === 1 && t0$41[0] === "assoc")) {
                                  decl_obj$0();
                                } else {
                                  if ($$3388$0 && (t1$14 === 3 && t0$41[0] === "assoc")) {
                                    k$3 = t0$41[1];v$7 = t0$41[2];decl_obj$0();obj$0.push(["array", k$3, v$7]);
                                  } else {
                                    if ($$3388$0 && (($$3390$0 = t1$14 === 2) && t0$41[0] === "dynsplice")) {
                                      expr$8 = t0$41[1];index$0 = null;new_arr_part$0();arr_parts$0.push(expr$8);
                                    } else {
                                      if ($$3390$0 && t0$41[0] === "objsplice") {
                                        expr$9 = t0$41[1];decl_obj$0();new_obj_part$0();obj_parts$0.push(expr$9);
                                      } else {
                                        other$13 = m$38;if (nequal(index$0, null)) {
                                          index$0 = index$0 + 1;
                                        }arr$0.push(other$13);
                                      }
                                    }
                                  }
                                }
                              }
                            } catch (err) {
                              _didIteratorError3 = true;
                              _iteratorError3 = err;
                            } finally {
                              try {
                                if (!_iteratorNormalCompletion3 && _iterator3["return"]) {
                                  _iterator3["return"]();
                                }
                              } finally {
                                if (_didIteratorError3) {
                                  throw _iteratorError3;
                                }
                              }
                            }

                            new_arr_part$0();is_obj$0 = nequal(objindex$0, null);if (is_obj$0 && nequal(arr_parts$0, [])) {
                              obj$0.push(["array", ["value", "::objinsert"], ["value", objindex$0]]);
                            }new_obj_part$0();f$3 = function f(x$12, rest$0) {
                              return ["send", ["symbol", "&:"], ["data", x$12, rest$0]];
                            };obj$0 = util$0.construct(obj_parts$0, f$3, ["object"]);f$4 = function f(x$13, rest$1) {
                              return ["send", ["send", rest$1, ["send", ["symbol", "."], ["data", ["void"], ["symbol", "concat"]]]], ["data", x$13]];
                            };arr$0 = util$0.construct(arr_parts$0.reverse(), f$4, ["array"]);m$39$0 = arr_parts$0;if (Array.isArray(m$39$0) && (t0$42 = m$39$0.length, t0$42 === 0 && is_obj$0)) {
                              r$0 = obj$0;
                            } else {
                              if (is_obj$0) {
                                r$0 = ["send", ["symbol", "&:"], ["data", arr$0, obj$0]];
                              } else {
                                other$14 = m$39$0;r$0 = arr$0;
                              }
                            }return helper$1(context$9, scope$13, $it$32.mkenv().mark(r$0));
                          } else {
                            if ($$2920$0 && (t0$29 === 3 && m$28$0[0] === "assign")) {
                              target$0 = m$28$0[1];value$8 = m$28$0[2];t$2 = helper$1(["expr", "expr"], scope$13, target$0);orig$0 = t$2.origin || {};m$40$0 = t$2;if ((x$14 = m$40$0, x$14 instanceof Array && x$14[0] === "variable") && (!t$2.mutable && orig$0.assigned && orig$0.assigned.group_id !== target$0.group_id)) {
                                msg$5 = ["Variable was declared as read-only. Declare it as", "mutable at the origin with `var` (if you have access", "to the declaration) or declare a new variable with", "`let` or `var` or remove the original binding with", "`delete`"].join(" ");throw ErrorFactory(["syntax"]).create(msg$5, { variable: target$0, loc: t$2.assigned });
                              } else {
                                if (Array.isArray(m$40$0) && (t0$43 = m$40$0.length, t0$43 === 2 && m$40$0[0] === "macro")) {
                                  m$41 = m$40$0[1];["bounce", m$41(["assign"], scope$13, expr$7, value$8)];
                                } else {
                                  otherwise$0 = m$40$0;$targ$31 = target$0;orig$0.assigned = $targ$31;void 0;
                                }
                              }return ["assign", t$2, helper$1(["expr", "expr"], scope$13, value$8)];
                            } else {
                              if ($$2920$0 && (t0$29 === 4 && m$28$0[0] === "lambda")) {
                                bindings$2 = m$28$0[1];body$1 = m$28$0[2];generator$0 = m$28$0[3];newscope$3 = Scope$0(scope$13);return ["lambda", (acc$10 = [], temp$22 = null, m$42 = null, (function () {
                                  var _iteratorNormalCompletion4 = true;
                                  var _didIteratorError4 = false;
                                  var _iteratorError4 = undefined;

                                  try {
                                    $21: for (var _iterator4 = bindings$2[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
                                      m$42 = _step4.value;
                                      var v$8 = undefined;var x$15 = undefined;var other$15 = undefined;var v$9 = undefined;var b$1 = undefined;var env$7 = undefined;var $$3663$0 = undefined;var t0$45 = undefined;var t1$15 = undefined;var binding$0 = undefined;var ph$7$0 = undefined;var t0$44 = undefined;t0$44 = m$42;binding$0 = t0$44;ph$7$0 = t0$44;t0$45 = ph$7$0;if (Array.isArray(t0$45) && (t1$15 = t0$45.length, t1$15 === 2 && (t0$45[0] === "symbol" && (b$1 = t0$45[1], ___hasprop(t0$45, "env"))))) {
                                        env$7 = t0$45.env;v$8 = __lt____lt____colon__$0(["variable", $it$32.gensym(b$1)], binding$0);__amp____colon__(v$8, { mutable: binding$0.mutable, group_id: binding$0.group_id, assigned: v$8 });env$7.bind(newscope$3, b$1, v$8);temp$22 = v$8;
                                      } else {
                                        if ((x$15 = t0$45, x$15 instanceof Array && x$15[0] === "variable")) {
                                          v$9 = t0$45;temp$22 = v$9;
                                        } else {
                                          other$15 = ph$7$0;throw ErrorFactory(["syntax", "lambda", "binding"]).create("Not a valid binding.", { node: other$15 });
                                        }
                                      }acc$10.push(temp$22);
                                    }
                                  } catch (err) {
                                    _didIteratorError4 = true;
                                    _iteratorError4 = err;
                                  } finally {
                                    try {
                                      if (!_iteratorNormalCompletion4 && _iterator4["return"]) {
                                        _iterator4["return"]();
                                      }
                                    } finally {
                                      if (_didIteratorError4) {
                                        throw _iteratorError4;
                                      }
                                    }
                                  }
                                })(), acc$10), helper$1(["expr", "expr"], newscope$3, body$1), generator$0];
                              } else {
                                if ($$2920$0 && (($$2922$0 = t0$29 === 3) && m$28$0[0] === "use")) {
                                  ph$6$0 = m$28$0[1];x$16 = m$28$0[2];t0$46 = ph$6$0;if (typeof t0$46 === "string") {
                                    name$9 = t0$46;s$9 = scope$13;$22: while (s$9) {
                                      if (s$9.name.slice(0, name$9.length + 1) === name$9 + "/") {
                                        break $22;
                                      } else {
                                        s$9 = s$9.parent;s$9;
                                      }
                                    }if (s$9) {
                     