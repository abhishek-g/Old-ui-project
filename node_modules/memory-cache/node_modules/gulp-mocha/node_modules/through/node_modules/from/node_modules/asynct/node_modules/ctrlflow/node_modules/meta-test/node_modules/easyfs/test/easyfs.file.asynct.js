var fs = require ('fs')
  , path = require ('path')
  , easyfs = require ('easyfs')
  , inspect = require('sys').inspect
  , assert = require('assert')
exports ['can save a temp file'] = function (test){

  var obj = {obj: 1234453}
  var temp = easyfs.Temp()
  temp.save(obj)
  temp.load(c)
  console.log(temp.path)
  function c(err,_obj){
    test.ifError(err)
    test.deepEqual(_obj,obj)
    test.finish()
  }
}

/*

OKAY: tempfiles

also, curry the interface so you can say:
easyfs.open('file').write('dsgasdgas')
or
easyfs.openTemp().write('dsgasdgas')
*/

exports ['can open a file'] = function (test){
   

  var t = easyfs.Temp()
  test.equal(t.isOpen,false)
  t.open ('w', c)
  function c(err){
   test.ifError(err)
   test.equal (t.isOpen, true,"file should be open")
    t.close(c)
    function c(){
      test.equal(t.isOpen,false)
      test.finish()      
      } } }


exports ['can open and write to a file'] = function (test){

  var t = easyfs.Temp()
  t.write("hello ",c) // automaticially opens file.
  function c(){
//    test.ok(false)

    t.close(test.finish)
    }
}

exports ['can open and write to a file, and then read'] = function (test){

  var t = easyfs.Temp()
  t.write("hello ",c) // automaticially opens file.
  function c(){
//    t.write("there\n",c)
  //  function c(){
      t.close(c)
      function c(){
//            test.finish() 
          var read = t.read(c)
          function c (err,text){
            test.ifError(err)
//            test.equal(text,"hello there\n")
            test.equal(text,"hello ")

            test.finish() 
            } } } } 
            //}


exports ['write/writeln callback only once'] = function (test){

  var t = easyfs.Temp()
    , calls = 0
    , lines = 0
  t.write("1\n",c) // automaticially opens file if necessary
  t.write("2\n",c)
  t.writeln("3",c)
  t.writeln("4",c)

  function c(err){
    test.ifError(err)
    test.finish()
    } }

exports ['can read a file a line at a time'] = function (test){
  var t = easyfs.Temp()
    , lines = 0

  t.write([1,2,